name: CI

on:
  pull_request:
    branches: [main]
    types: [opened, edited, synchronize]

jobs:
  check-for-cc:
    runs-on: ubuntu-latest
    steps:
      - name: check-for-cc
        id: check-for-cc
        uses: agenthunt/conventional-commit-checker-action@v2.0.0
  check-tag:
    permissions:
      contents: read
    runs-on: ubuntu-latest
    needs: [check-for-cc]
    if: needs.check-for-cc.result == 'success'
    steps:
    - uses: actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b # v4.1.4
      with:
        fetch-depth: 0
    - id: ccv
      name: Tag Increment Generator
      uses: smlx/ccv@c5f6769c943c082c4e8d8ccf2ec4b6f5f517e1f2 # v0.7.3
      with:
        write-tag: false
    - name: Visualise Incremented Tag
      env:
        NEW_TAG: ${{ steps.ccv.outputs.new-tag }}
        NEW_TAG_VERSION: ${{ steps.ccv.outputs.new-tag-version }}
        NEW_TAG_VERSION_TYPE: ${{ steps.ccv.outputs.new-tag-version-type }}
      run: |
        echo "new-tag=${NEW_TAG}"
        echo "new-tag-version=${NEW_TAG_VERSION}"
        echo "new-tag-version-type=${NEW_TAG_VERSION_TYPE}"